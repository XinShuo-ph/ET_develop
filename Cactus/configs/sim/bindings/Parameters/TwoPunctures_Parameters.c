/*@@
   @file    TwoPunctures_Parameters.c
   @author  Automatically generated by CreateParameterBindings.pl
   @desc
            Creates/extends parameters for this thorn
   @enddesc
 @@*/


#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>

#include "cctk_Config.h"
#include "cctk_Constants.h"
#include "ParameterBindings.h"
#include "CParameterStructNames.h"
#include "ParameterCRestrictedADMBASE.h"
#include "ParameterCRestrictedIO.h"
#include "ParameterCRestrictedSTATICCONFORMAL.h"

/* structure containing all private parameters of thorn TwoPunctures */
struct
{
  int dummy_parameter;
} PRIVATE_TWOPUNCTURES_STRUCT;


/* structure containing all restricted parameters of thorn TwoPunctures */
struct
{
  CCTK_REAL Newton_tol;
  CCTK_REAL TP_Extend_Radius;
  CCTK_REAL TP_Tiny;
  CCTK_REAL TP_epsilon;
  CCTK_REAL adm_tol;
  CCTK_REAL center_offset[3];
  CCTK_REAL initial_lapse_psi_exponent;
  CCTK_REAL par_P_minus[3];
  CCTK_REAL par_P_plus[3];
  CCTK_REAL par_S_minus[3];
  CCTK_REAL par_S_plus[3];
  CCTK_REAL par_b;
  CCTK_REAL par_m_minus;
  CCTK_REAL par_m_plus;
  CCTK_REAL target_M_minus;
  CCTK_REAL target_M_plus;
  const char * grid_setup_method;
  CCTK_INT Newton_maxit;
  CCTK_INT do_initial_debug_output;
  CCTK_INT do_residuum_debug_output;
  CCTK_INT give_bare_mass;
  CCTK_INT keep_u_around;
  CCTK_INT multiply_old_lapse;
  CCTK_INT npoints_A;
  CCTK_INT npoints_B;
  CCTK_INT npoints_phi;
  CCTK_INT rescale_sources;
  CCTK_INT schedule_in_ADMBase_InitialData;
  CCTK_INT solve_momentum_constraint;
  CCTK_INT swap_xz;
  CCTK_INT use_external_initial_guess;
  CCTK_INT use_sources;
  CCTK_INT verbose;
} RESTRICTED_TWOPUNCTURES_STRUCT;


int CCTKi_BindingsCreateTwoPuncturesParameters(void);
int CCTKi_BindingsCreateTwoPuncturesParameters(void)
{
  CCTKi_ParameterCreate("Newton_maxit",
                        "TwoPunctures",
                        "INT",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Maximum number of Newton iterations",
                        "5",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.Newton_maxit),
                        0,
                        NULL,
                        1,
                        "0:*", "");

  CCTKi_ParameterCreate("Newton_tol",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Tolerance for Newton solver",
                        "1.0e-10",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.Newton_tol),
                        0,
                        NULL,
                        1,
                        "(0:*)", "");

  CCTKi_ParameterCreate("TP_Extend_Radius",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Radius of an extended spacetime instead of the puncture",
                        "0.0",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.TP_Extend_Radius),
                        0,
                        NULL,
                        1,
                        "0:*", "anything positive, should be smaller than the horizon");

  CCTKi_ParameterCreate("TP_Tiny",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Tiny number to avoid nans near or at the pucture locations",
                        "0.0",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.TP_Tiny),
                        0,
                        NULL,
                        1,
                        "0:*", "anything positive, usually very small");

  CCTKi_ParameterCreate("TP_epsilon",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "A small number to smooth out singularities at the puncture locations",
                        "0.0",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.TP_epsilon),
                        0,
                        NULL,
                        1,
                        "0:*", "");

  CCTKi_ParameterCreate("adm_tol",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Tolerance of ADM masses when give_bare_mass=no",
                        "1.0e-10",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.adm_tol),
                        0,
                        NULL,
                        1,
                        "(0:*)", "");

  CCTKi_ParameterCreate("center_offset",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "offset b=0 to position (x,y,z)",
                        "0.0",
                        (RESTRICTED_TWOPUNCTURES_STRUCT.center_offset),
                        3,
                        NULL,
                        1,
                        "(*:*)", "");

  CCTKi_ParameterCreate("do_initial_debug_output",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Output debug information about initial guess",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.do_initial_debug_output),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("do_residuum_debug_output",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Output debug information about the residuum",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.do_residuum_debug_output),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("give_bare_mass",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "User provides bare masses rather than target ADM masses",
                        "yes",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.give_bare_mass),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("grid_setup_method",
                        "TwoPunctures",
                        "KEYWORD",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "How to fill the 3D grid from the spectral grid",
                        "Taylor expansion",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.grid_setup_method),
                        0,
                        NULL,
                        2,
                        "Taylor expansion", "use a Taylor expansion about the nearest collocation point (fast, but might be inaccurate)",
                        "evaluation", "evaluate using all spectral coefficients (slow)");

  CCTKi_ParameterCreate("initial_lapse_psi_exponent",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Exponent n for psi^-n initial lapse profile",
                        "-2.0",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.initial_lapse_psi_exponent),
                        0,
                        NULL,
                        1,
                        "(*:*)", "Should be negative");

  CCTKi_ParameterCreate("keep_u_around",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Keep the variable u around after solving",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.keep_u_around),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("multiply_old_lapse",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Multiply the old lapse with the new one",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.multiply_old_lapse),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("npoints_A",
                        "TwoPunctures",
                        "INT",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Number of coefficients in the compactified radial direction",
                        "30",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.npoints_A),
                        0,
                        NULL,
                        1,
                        "4:*", "");

  CCTKi_ParameterCreate("npoints_B",
                        "TwoPunctures",
                        "INT",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Number of coefficients in the angular direction",
                        "30",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.npoints_B),
                        0,
                        NULL,
                        1,
                        "4:*", "");

  CCTKi_ParameterCreate("npoints_phi",
                        "TwoPunctures",
                        "INT",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Number of coefficients in the phi direction",
                        "16",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.npoints_phi),
                        0,
                        NULL,
                        1,
                        "4:*:2", "");

  CCTKi_ParameterCreate("par_P_minus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "momentum of the m- puncture",
                        "0.0",
                        (RESTRICTED_TWOPUNCTURES_STRUCT.par_P_minus),
                        3,
                        NULL,
                        1,
                        "(*:*)", "");

  CCTKi_ParameterCreate("par_P_plus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "momentum of the m+ puncture",
                        "0.0",
                        (RESTRICTED_TWOPUNCTURES_STRUCT.par_P_plus),
                        3,
                        NULL,
                        1,
                        "(*:*)", "");

  CCTKi_ParameterCreate("par_S_minus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "spin of the m- puncture",
                        "0.0",
                        (RESTRICTED_TWOPUNCTURES_STRUCT.par_S_minus),
                        3,
                        NULL,
                        1,
                        "(*:*)", "");

  CCTKi_ParameterCreate("par_S_plus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "spin of the m+ puncture",
                        "0.0",
                        (RESTRICTED_TWOPUNCTURES_STRUCT.par_S_plus),
                        3,
                        NULL,
                        1,
                        "(*:*)", "");

  CCTKi_ParameterCreate("par_b",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_ALWAYS,
                        "x coordinate of the m+ puncture",
                        "1.0",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.par_b),
                        0,
                        NULL,
                        1,
                        "(0.0:*)", "");

  CCTKi_ParameterCreate("par_m_minus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_ALWAYS,
                        "mass of the m- puncture",
                        "1.0",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.par_m_minus),
                        0,
                        NULL,
                        1,
                        "0.0:*)", "");

  CCTKi_ParameterCreate("par_m_plus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_ALWAYS,
                        "mass of the m+ puncture",
                        "1.0",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.par_m_plus),
                        0,
                        NULL,
                        1,
                        "0.0:*)", "");

  CCTKi_ParameterCreate("rescale_sources",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "If sources are used - rescale them after solving?",
                        "yes",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.rescale_sources),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("schedule_in_ADMBase_InitialData",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Schedule in (instead of after) ADMBase_InitialData",
                        "yes",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.schedule_in_ADMBase_InitialData),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("solve_momentum_constraint",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Solve for momentum constraint?",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.solve_momentum_constraint),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("swap_xz",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Swap x and z coordinates when interpolating, so that the black holes are separated in the z direction",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.swap_xz),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("target_M_minus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "target ADM mass for m-",
                        "0.5",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.target_M_minus),
                        0,
                        NULL,
                        1,
                        "0.0:*)", "");

  CCTKi_ParameterCreate("target_M_plus",
                        "TwoPunctures",
                        "REAL",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "target ADM mass for m+",
                        "0.5",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.target_M_plus),
                        0,
                        NULL,
                        1,
                        "0.0:*)", "");

  CCTKi_ParameterCreate("use_external_initial_guess",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Set initial guess by external function?",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.use_external_initial_guess),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("use_sources",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Use sources?",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.use_sources),
                        0,
                        NULL,
                        0);

  CCTKi_ParameterCreate("verbose",
                        "TwoPunctures",
                        "BOOLEAN",
                        "RESTRICTED",
                        CCTK_STEERABLE_NEVER,
                        "Print screen output while solving",
                        "no",
                        &(RESTRICTED_TWOPUNCTURES_STRUCT.verbose),
                        0,
                        NULL,
                        0);

  return 0;
}

int CCTKi_BindingsTwoPuncturesParameterExtensions(void);
int CCTKi_BindingsTwoPuncturesParameterExtensions(void)
{
  CCTKi_ParameterAddRange("ADMBASE",
                          "initial_data",
                          "TwoPunctures",
                          "twopunctures",
                          "two puncture black holes");

  CCTKi_ParameterAddRange("ADMBASE",
                          "initial_lapse",
                          "TwoPunctures",
                          "twopunctures-antisymmetric",
                          "antisymmetric lapse for two puncture black holes, -1 <= alpha <= +1");

  CCTKi_ParameterAddRange("ADMBASE",
                          "initial_lapse",
                          "TwoPunctures",
                          "twopunctures-averaged",
                          "averaged lapse for two puncture black holes, 0 <= alpha <= +1");

  CCTKi_ParameterAddRange("ADMBASE",
                          "initial_lapse",
                          "TwoPunctures",
                          "psi^n",
                          "Based on the initial conformal factor");

  CCTKi_ParameterAddRange("ADMBASE",
                          "initial_lapse",
                          "TwoPunctures",
                          "brownsville",
                          "See Phys. Rev. D 74, 041501 (2006)");

  return 0;
}

